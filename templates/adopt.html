
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Adopt a Pet | FurrEver</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
:root{
    --primary:#ff7a00;
    --text-dark:#1f2937;
    --text-light:#6b7280;
    --bg:#f4f6f8;
    --card:#ffffff;
    --border:#e5e7eb;
}

*{ box-sizing:border-box; }

body{
    margin:0;
    font-family:'Poppins',sans-serif;
    background:var(--bg);
    color:var(--text-dark);
}

/* CONTAINER */
.container{
    max-width:1200px;
    margin:auto;
    padding:50px 20px;
}

h1{
    text-align:center;
    font-size:30px;
    font-weight:600;
    margin-bottom:50px;
}

/* GRID */
.pet-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
    gap:30px;
}

/* CARD */
.pet-card{
    background:var(--card);
    border:1px solid var(--border);
    border-radius:16px;
    overflow:hidden;
    transition:all .25s ease;
    display:flex;
    flex-direction:column;
}

.pet-card:hover{
    transform:translateY(-6px);
    box-shadow:0 10px 25px rgba(0,0,0,0.08);
}

/* IMAGE WRAPPER */
.pet-image-wrapper{
    width:100%;
    aspect-ratio:1/1;
    overflow:hidden;
    background:#f1f1f1;
}

.pet-image-wrapper img{
    width:100%;
    height:100%;
    object-fit:cover;
    display:block;
}

/* CONTENT */
.pet-info{
    padding:18px 20px 22px;
    display:flex;
    flex-direction:column;
    gap:6px;
}

.pet-info h3{
    margin:0;
    font-size:18px;
    font-weight:600;
}

.type{
    font-size:14px;
    font-weight:500;
    color:var(--primary);
}

.pet-info p{
    font-size:14px;
    color:var(--text-light);
    margin:2px 0;
}

/* BUTTON */
.details-btn{
    margin-top:12px;
    display:block;
    text-align:center;
    padding:12px;
    border-radius:10px;
    background:var(--primary);
    color:white;
    font-size:14px;
    font-weight:600;
    text-decoration:none;
    transition:.2s;
}

.details-btn:hover{
    background:#ff6500;
}

/* MAP SECTION */
.map-section{
    max-width:1200px;
    margin:70px auto;
    padding:30px;
    background:white;
    border-radius:16px;
    border:1px solid var(--border);
}

.map-section h2{
    text-align:center;
    margin-bottom:15px;
}

.search{
    display:flex;
    justify-content:center;
    gap:10px;
    margin-bottom:20px;
}

.search input{
    padding:10px;
    border-radius:8px;
    border:1px solid var(--border);
    width:240px;
    outline:none;
}

.search button{
    padding:10px 18px;
    border:none;
    background:var(--primary);
    color:white;
    border-radius:8px;
    cursor:pointer;
    font-weight:500;
}

.search button:hover{
    background:#ff6500;
}

#map{
    height:450px;
    width:100%;
    border-radius:16px;
}

.shelter-card .btn {
  display: inline-block;
  margin-top: 6px;
  padding: 5px 10px;
  background: #4CAF50;
  color: #fff;
  text-decoration: none;
  border-radius: 4px;
  font-size: 13px;
}

.shelter-card .btn:hover {
  background: #45a049;
}

/* HEADER WITH RIGHT BUTTON */
.page-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:50px;
}

.page-header h1{
    margin:0;
    font-size:30px;
    font-weight:600;
}

.home-btn{
    padding:10px 18px;
    background:var(--primary);
    color:white;
    text-decoration:none;
    border-radius:10px;
    font-size:14px;
    font-weight:500;
    transition:.2s;
}

.home-btn:hover{
    background:#ff6500;
}


</style>
</style>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

</head>
<body>

<div class="container">
    <!--h1>Pets Available for Adoption üêæ</h1>-->
    <div class="page-header">
    <h1>Pets Available for Adoption üêæ</h1>
    <a href="{{ url_for('home') }}" class="home-btn">Back to Home</a>
</div>

    <div class="pet-grid">
        {% for pet in pets %}
        <div class="pet-card">

            <div class="pet-image-wrapper">
                {% if pet.image %}
                <img src="{{ url_for('static', filename='uploads/' + pet.image) }}" alt="{{ pet.name }}">
                {% else %}
                <img src="{{ url_for('static', filename='default.jpg') }}" alt="No Image">
                {% endif %}
            </div>

            <div class="pet-info">
                <h3>{{ pet.name }}</h3>
                <div class="type">{{ pet.type }}</div>

                <p><strong>Breed:</strong> {{ pet.breed }}</p>
                <p><strong>Age:</strong> {{ pet.age }} years</p>
                <p><strong>Location:</strong> {{ pet.location }}</p>

                <a href="{{ url_for('pet_details', pet_id=pet.id) }}" class="details-btn">
                    View Full Profile ‚Üí
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- MAP SECTION -->
<div class="map-section">

<h2>Nearby Animal Shelters</h2>

<div class="search">
  <input type="text" id="searchBox" placeholder="Search city / place">
  <button onclick="searchLocation()">Search</button>
</div>

<div id="map"></div>

</div>

<script>
var map=L.map('map').setView([9.9312,76.2673],13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
.addTo(map);

var markers=[];

function searchLocation(){
 let city=document.getElementById("searchBox").value;

 fetch("/get-map-data?city="+city)
 .then(res=>res.json())
 .then(data=>{

  markers.forEach(m=>map.removeLayer(m));
  markers=[];

  if(data.shelters.length==0){
    alert("No shelters found");
    return;
  }

  map.setView(
   [data.shelters[0].latitude,
    data.shelters[0].longitude],13);

  /*data.shelters.forEach(s=>{
    let m=L.marker([s.latitude,s.longitude])
    .addTo(map)
    .bindPopup(
     `<b>${s.name}</b><br>${s.address}`
    );
    markers.push(m);
  });*/
  data.shelters.forEach(s => {
  let popupContent = `
    <div class="shelter-card">
      <h3>${s.name}</h3>
      <p>${s.address}</p>
      <p><strong>City:</strong> ${s.city}</p>
      <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(
        s.name + ', ' + s.address + ', ' + s.city
    )}"
         target="_blank" class="btn">View on Map</a>
    </div>
  `;

  let m = L.marker([s.latitude, s.longitude])
    .addTo(map)
    .bindPopup(popupContent);

  markers.push(m);
});
 });
}
</script>

</body>
</html>
