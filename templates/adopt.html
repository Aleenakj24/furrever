
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Adopt a Pet | FurrEver</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background: #f6f7f9;
        }

        .container {
            padding: 50px;
        }

        h1 {
            text-align: center;
            margin-bottom: 40px;
            color: #2c3e50;
        }

        /*.pet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
        }*/
        .pet-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px;
    align-items: stretch;
}

.pet-card {
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    overflow: hidden;

    display: flex;
    flex-direction: column;   /* ‚¨Ö important */
}
.pet-card img {
    width: 100%;
    height: 220px;
    object-fit: cover;
    display: block;
}
.pet-info {
    padding: 20px;
    text-align: left;   /* ‚¨Ö stop center alignment */
    flex: 1;
}
.details-btn {
    display: inline-block;
    margin-top: 15px;
}
h1 {
    text-align: center;
}

.pet-info h3 {
    text-align: left;
}

        /*.pet-card {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .pet-card img {
            width: 100%;
            height: 230px;
            object-fit: cover;
        }

        .pet-info {
            padding: 20px;
        }

        .pet-info h3 {
            margin: 0;
            font-size: 20px;
        }*/

        .type {
            color: #ff7a00;
            font-weight: 500;
            margin: 4px 0 10px;
        }

        .pet-info p {
            font-size: 14px;
            color: #555;
            margin: 4px 0;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 10px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
        }

        .details-btn {
    display: inline-block;
    margin-top: 10px;
    padding: 10px 16px;
    background: linear-gradient(135deg, #ff8c42, #ff6f00);
    color: white;
    text-decoration: none;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 6px 16px rgba(255, 122, 0, 0.3);
}

.details-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 24px rgba(255, 122, 0, 0.45);
    background: linear-gradient(135deg, #ff6f00, #ff5200);
}


        .adopt-btn {
            background: #ff7a00;
            color: white;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            width: 420px;
            padding: 25px;
            border-radius: 16px;
        }

        .modal-content h3 {
            margin-top: 0;
        }

        .close {
            float: right;
            font-size: 18px;
            cursor: pointer;
        }
    </style>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">  
    <style>
    #map{
        height:450px !important;
        width:100% !important;
        background:#eee;
    }
    </style>
    <!-- Leaflet -->
    <link rel="stylesheet"href="https://unpkg.com/leaflet/dist/leaflet.css"/>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>

<body>

<div class="container">
    <h1>Pets Available for Adoption üêæ</h1>

    <div class="pet-grid">
        {% for pet in pets %}
        <div class="pet-card">
            <img src="{{ url_for('static', filename='uploads/' + pet.image) }}">

            <div class="pet-info">
                <h3>{{ pet.name }}</h3>
                <div class="type">{{ pet.type }}</div>

                <p><strong>Breed:</strong> {{ pet.breed }}</p>
                <p><strong>Age:</strong> {{ pet.age }} years</p>
                <p><strong>Location:</strong> {{ pet.location }}</p>

                <div class="btn-group">
                   <a href="{{ url_for('pet_details', pet_id=pet.id) }}" class="details-btn">View Full Profile ‚Üí</a>

                </div>
            </div>
        </div>

        <!-- MODAL -->
        <input type="checkbox" id="modal{{ pet.id }}" hidden>
        <div class="modal">
            <div class="modal-content">
                <label for="modal{{ pet.id }}" class="close">‚úñ</label>

                <h3>{{ pet.name }} ‚Äì Details</h3>
                <p>{{ pet.description }}</p>

                <hr>

                <p><strong>Owner:</strong> {{ pet.owner_name }}</p>
                <p><strong>Phone:</strong> {{ pet.owner_phone }}</p>
                {% if pet.owner_email %}
                <p><strong>Email:</strong> {{ pet.owner_email }}</p>
                {% endif %}
                <p><strong>Location:</strong> {{ pet.location }}</p>
            </div>
  
        </div>
        {% endfor %}

     
    </div>
</div>

<script>
    document.querySelectorAll('.details-btn').forEach((btn, index) => {
        btn.onclick = () => {
            document.querySelectorAll('.modal')[index].style.display = 'flex';
        };
    });
    document.querySelectorAll('.close').forEach((btn) => {
        btn.onclick = () => {
            btn.closest('.modal').style.display = 'none';
        };
    });
</script>


<SHELTER MAP SECTION -->
<div style="max-width:1100px;margin:50px auto">

<h2 style="text-align:center;margin-bottom:15px">
Nearby Animal Shelters
</h2>

<div class="search" style="text-align:center;margin-bottom:15px">
  <input type="text" id="searchBox"
   placeholder="Search city / place"
   style="padding:10px;border-radius:8px;border:1px solid #ccc">
  <button onclick="searchLocation()"
   style="padding:10px 16px;border:none;
   background:#ff7a00;color:white;border-radius:8px">
   Search
  </button>
</div>

<div id="map"
 style="height:450px;width:100%;
 border-radius:16px;
 box-shadow:0 6px 18px rgba(0,0,0,0.1)">
</div>

</div>

<script>
var map=L.map('map').setView([9.9312,76.2673],13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
.addTo(map);

var markers=[];

function searchLocation(){

 let city=document.getElementById("searchBox").value;

 fetch("/get-map-data?city="+city)
 .then(res=>res.json())
 .then(data=>{

  // clear old markers
  markers.forEach(m=>map.removeLayer(m));
  markers=[];

  if(data.shelters.length==0){
    alert("No shelters found");
    return;
  }

  // center map to first result
  map.setView(
   [data.shelters[0].latitude,
    data.shelters[0].longitude],13);

  data.shelters.forEach(s=>{

    let m=L.marker([s.latitude,s.longitude])
    .addTo(map)
    .bindPopup(
     `<b>${s.name}</b><br>${s.address}`
    );

    markers.push(m);
  });

 });
}
</script>

</body>
</html>